<!-- board/templates/board/post_detail.html -->
{% extends "base.html" %}

{% block content %}
  <div class="post-detail">
    <!-- ê²Œì‹œê¸€ ë‚´ìš© -->
    <div class="post-header">
      <h1>
  {% if post.category != 'home' %}
    [{{ post.get_category_display }}] {{ post.title }}
  {% else %}
    {{ post.title }}
  {% endif %}
</h1>
      <div class="post-meta">
        <span>ì‘ì„±ì: {{ post.author }}</span>
        <span>ì‘ì„±ì¼: {{ post.pub_date|date:"Y-m-d H:i" }}</span>
        <span>ì¡°íšŒìˆ˜: {{ post.views }}</span>
        <span>ì¢‹ì•„ìš”: {{ post.likes.count }}</span>
        <a href="{% url 'post_like' post.pk %}" class="like-button">
          {% if request.user in post.likes.all %}â¤ï¸{% else %}ğŸ¤{% endif %}
        </a>
      </div>
    </div>

    {% if post.image %}
      <div style="margin-bottom:1rem;">
        <img src="{{ post.image.url }}" alt="ì²¨ë¶€ ì´ë¯¸ì§€" style="max-width:100%; border-radius:8px;">
      </div>
    {% endif %}

    <div class="post-content">
      {{ post.content|linebreaks }}
    </div>

    <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
    <div class="comment-section">
      <h3>ëŒ“ê¸€ ({{ post.comments.count }})</h3>
      <form method="post" class="comment-form">
        {% csrf_token %}
        {{ comment_form.content }}
        <button type="submit">ëŒ“ê¸€ ì‘ì„±</button>
      </form>

      <div class="comment-list">
        {% for comment in post.comments.all %}
          <div class="comment">
            <div class="comment-author">{{ comment.author }}</div>
            <div class="comment-content">{{ comment.content }}</div>
            <div class="comment-date">{{ comment.created_at|date:"Y-m-d H:i" }}</div>
          </div>
        {% empty %}
          <p>ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}
